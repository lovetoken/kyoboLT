---
title: "kyoboLT package in R"
output:
  rmdformats::material:
    lightbox: F
    thumbnails: F
    fig_height: 5
    fig_width: 6.5
    keep_md: yes
---

```{r echo=F, message=FALSE, warning=FALSE}
## load packages
pacman::p_load("pacman", "dplyr", "knitr", "rmarkdown", "rmdformats", "xts", "reshape2", "formattable", "kyoboLT", "ggplot2")

## ggplot2 theme set
theme_set(theme_bw() + theme(axis.text.x = element_text(angle = 90)))

## option
opts_chunk$set(fig.align = "center", warning = F, message = F)
```

# `kyoboLT` package in R 

<br><img src="./image/under-construction-banner.png" width="20%"><br>

Useful R package for kyobo retirement pension marketing team.  

# install `kyoboLT` package

```{r eval=F}
devtools::install_github("lovetoken/kyoboLT")
```

# Useful functions for time series data

## `xdiff_returns()`

```{r}
data(sample_index)
sample_index

# basic 3 day returns
xdiff_returns(sample_index, 3)
# calculation 3 day log returns
xdiff_returns(sample_index, 3, log.returns = T)
# not omit about start time index
xdiff_returns(sample_index, 3, start.omit = F)
```

## `tmplot()`

Time series and (3 lines) moving average plot about all fund items

```{r}
library("quantmod")
data <- getSymbols("^ks11", from=Sys.Date()-1000, to = Sys.Date(), auto.assign = F)

tmplot(data)
```

## `efff()`

Efficient Frontier using excess earning rate

```{r}
returns <- xdiff_returns(sample_index, 1)
ef <- efff(returns, rg = 0.01039, rfr = 0.001, plot.only.efff = F)
attr(ef, "poolset") %>% head
```

# Useful manipulation

## `mmadjust()`

Adjust min & max about numeric vector

```{r}
(x <- c(NA, 1:100*.01, NA))
mmadjust(x, .2, .8)
```

## `trim()`

Trimming of whitespace in character

```{r}
trim("  Wow!  ", method = "leading")
trim("  Wow!  ", method = "trailing")
"  Wow!  " %>% trim %>% trim(method = "leading")
```

# For template

## `ky_colors()`

```{r}
demo.pal <- function(n, border = if (n < 32) "light gray" else NA,
                     main = paste("color palettes;  n=", n),
                     ch.col = c("rainbow(n, start=.7, end=.1)", "heat.colors(n)",
                                "terrain.colors(n)", "topo.colors(n)", 
                                "cm.colors(n)", "ky_colors(n)")){
  
    nt <- length(ch.col)
    i <- 1:n; j <- n / nt; d <- j/6; dy <- 2*d
    plot(i, i+d, type = "n", yaxt = "n", ylab = "", main = main)
    
    for(k in 1:nt){
        rect(i-.5, (k-1)*j+ dy, i+.4, k*j, col = eval(parse(text = ch.col[k])), border = border)
        text(2*j,  k * j + dy/4, ch.col[k])
    }
    
}

demo.pal(n = 16)
```

